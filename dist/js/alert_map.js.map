{"version":3,"file":"alert_map.js","names":["genMap","origin","destinations","mapboxAccessToken","profile_name","hq","hospitalList","mapBox","document","getElementById","mapDiv","hospitals","removeChild","newMapDiv","createElement","id","appendChild","mapboxgl","accessToken","map","Map","container","style","center","zoom","scrollZoom","updateMap","newDestinations","remove","pitch","bearing","antialias","on","addControl","NavigationControl","marker_origin","Marker","element","createCustomMarkerElementForOrigin","anchor","setLngLat","addTo","originCustomPopup","Popup","offset","setDOMContent","createCustomPopupContentForOrigin","setPopup","getElement","addEventListener","togglePopup","forEach","destination","index","nearestHospital","findNearestHospital","coordinates","hospitalApiUrl","fetch","then","response","ok","Error","json","data","hospitalRouteId","addSource","type","routes","geometry","addLayer","source","layout","paint","catch","error","console","marker_hospital","createCustomMarkerElementForHospital","hospital_name","hospital_address","hospitalCustomPopup","createCustomPopupContentForHospital","apiUrl","color","marker_destination","createCustomMarkerElementForDestination","properties","name","filepath","location_id","alert_by","destinationCustomPopup","createCustomPopupContentForDestination","setAttribute","fileUrl","alertLocation","alertBy","setContent","headerTogglers","getElementsByClassName","sidebarTogglers","i","length","setTimeout","resize","customMarker","className","backgroundImage","width","height","backgroundSize","popupContainer","popupContent","textContent","destinationCoordinates","minDistance","Infinity","hospital","distance","calculateDistance","lat","long","docId","coord1","coord2","R","dLat","deg2rad","dLon","a","Math","sin","cos","c","atan2","sqrt","deg","PI","isResponded","fileExtension","getFileExtension","videoElement","videoContainer","imageElement","imageContainer","incidentLocation","personWhoAlerted","respondButton","markAsDoneButton","classList","add","videoExtensions","imageExtensions","includes","display","src","load","imageLink","href","url","path","URL","pathname","parts","split","toLowerCase"],"sources":["../../src/js/alert_map.js"],"sourcesContent":["export function genMap(origin, destinations, mapboxAccessToken, profile_name, hq, hospitalList) {\r\n\r\n    // Find the parent element with id \"map-box\"\r\n    const mapBox = document.getElementById('map-box');\r\n\r\n    // Check if the map div already exists\r\n    const mapDiv = document.getElementById('map');\r\n\r\n    // Define the hospitals' coordinates\r\n    const hospitals = hospitalList;\r\n\r\n  //console.log('Hospital List:', hospitals);\r\n\r\n    if (mapDiv) {\r\n    // If it exists, remove it\r\n    mapBox.removeChild(mapDiv);\r\n    } \r\n\r\n    // If it doesn't exist, create and append the new div\r\n    const newMapDiv = document.createElement('div');\r\n    newMapDiv.id = 'map'; // Set the id attribute\r\n    mapBox.appendChild(newMapDiv);\r\n\r\n    // Initialize the map\r\n    mapboxgl.accessToken = mapboxAccessToken;\r\n    let map = new mapboxgl.Map({\r\n      container: 'map',\r\n      // Specify the ID of the container element\r\n      style: 'mapbox://styles/mapbox/streets-v11',\r\n      // Map style\r\n      center: origin,\r\n      // Initial map center\r\n      zoom: 16,\r\n      // Initial zoom level\r\n      scrollZoom: false // Disable zooming with the mouse scroll wheel\r\n    });\r\n  \r\n    // Create a function to update the map with new destinations\r\n    function updateMap(newDestinations) {\r\n     // console.log(newDestinations);\r\n      // Remove existing markers and routes\r\n\r\n      map.remove();\r\n\r\n      // Recreate the map\r\n      map = new mapboxgl.Map({\r\n        container: 'map',\r\n        style: 'mapbox://styles/mapbox/streets-v11',\r\n        center: origin,\r\n        zoom: 16,\r\n        pitch: 45,\r\n        bearing: -17.6,\r\n        container: 'map',\r\n        antialias: true,\r\n        scrollZoom: false\r\n      });\r\n      map.on('style.load', function () {\r\n\r\n        // Add a navigation control (optional)\r\n        map.addControl(new mapboxgl.NavigationControl());\r\n  \r\n        // Create a marker for the origin and name it marker_origin\r\n        const marker_origin = new mapboxgl.Marker({\r\n          element: createCustomMarkerElementForOrigin(),\r\n          anchor: 'center'\r\n        })\r\n          .setLngLat(origin)\r\n          .addTo(map);\r\n\r\n        // Create a origin custom popup\r\n        const originCustomPopup = new mapboxgl.Popup({ offset: 10 })\r\n          .setDOMContent(createCustomPopupContentForOrigin());\r\n\r\n        // Set the popup for the marker\r\n        marker_origin.setPopup(originCustomPopup);\r\n\r\n        // Show the popup on marker hover\r\n        marker_origin.getElement().addEventListener('mouseenter', () => {\r\n          marker_origin.togglePopup();\r\n        });\r\n\r\n        // Remove the popup on marker mouseleave\r\n        marker_origin.getElement().addEventListener('mouseleave', () => {\r\n          marker_origin.togglePopup();\r\n        });\r\n\r\n  \r\n        // Loop through the new destinations and calculate routes\r\n        newDestinations.forEach((destination, index) => {\r\n\r\n          // Find the nearest hospital\r\n          const nearestHospital = findNearestHospital(destination.coordinates, hospitals);\r\n          //console.log(nearestHospital.nearestHospital)\r\n\r\n          // Use the Mapbox Directions API to calculate and display the route from destination to the nearest hospital\r\n          const hospitalApiUrl = `https://api.mapbox.com/directions/v5/mapbox/driving/${destination.coordinates[0]},${destination.coordinates[1]};${nearestHospital.nearestHospital[1]},${nearestHospital.nearestHospital[0]}?alternatives=true&geometries=geojson&language=en&overview=full&steps=true&access_token=${mapboxAccessToken}`;\r\n          fetch(hospitalApiUrl).then(response => {\r\n            if (!response.ok) {\r\n              throw new Error('Network response was not ok');\r\n            }\r\n            return response.json();\r\n          }).then(data => {\r\n            // Add the route to the map with a different color\r\n            const hospitalRouteId = `hospital-route-${index}`;\r\n            map.addSource(hospitalRouteId, {\r\n              type: 'geojson',\r\n              data: data.routes[0].geometry\r\n            });\r\n            map.addLayer({\r\n              id: hospitalRouteId,\r\n              type: 'line',\r\n              source: hospitalRouteId,\r\n              layout: {\r\n                'line-join': 'round',\r\n                'line-cap': 'round'\r\n              },\r\n              paint: {\r\n                'line-color': 'green', // Set the color for the hospital route\r\n                'line-width': 6\r\n              }\r\n            });\r\n          }).catch(error => {\r\n            console.error('There was a problem with the fetch operation:', error);\r\n          });\r\n\r\n          // Create a marker for the hospital and name it marker_hospital\r\n          const marker_hospital = new mapboxgl.Marker({\r\n            element: createCustomMarkerElementForHospital(index),\r\n            anchor: 'center'\r\n          })\r\n            .setLngLat([nearestHospital.nearestHospital[1], nearestHospital.nearestHospital[0]])\r\n            .addTo(map);\r\n\r\n          const hospital_name = nearestHospital.hospital_name;\r\n          const hospital_address = nearestHospital.hospital_address;\r\n\r\n          // Create a hospital custom popup\r\n          const hospitalCustomPopup = new mapboxgl.Popup({ offset: 10 })\r\n            .setDOMContent(createCustomPopupContentForHospital(hospital_name, hospital_address));\r\n\r\n          // Set the popup for the marker\r\n          marker_hospital.setPopup(hospitalCustomPopup);\r\n\r\n          // Show the popup on marker hover\r\n          marker_hospital.getElement().addEventListener('mouseenter', () => {\r\n            hospitalCustomPopup.addTo(map);\r\n          });\r\n\r\n          // Remove the popup on marker mouseleave\r\n          marker_hospital.getElement().addEventListener('mouseleave', () => {\r\n            hospitalCustomPopup.remove();\r\n          });\r\n          \r\n          // Use the Mapbox Directions API to calculate and display the route\r\n          const apiUrl = `https://api.mapbox.com/directions/v5/mapbox/driving/${origin[0]},${origin[1]};${destination.coordinates[0]},${destination.coordinates[1]}?alternatives=true&geometries=geojson&language=en&overview=full&steps=true&access_token=${mapboxAccessToken}`;\r\n          fetch(apiUrl).then(response => {\r\n            if (!response.ok) {\r\n              throw new Error('Network response was not ok');\r\n            }\r\n            return response.json();\r\n          }).then(data => {\r\n            // Add the route to the map with the specified color\r\n            map.addSource(`route-${index}`, {\r\n              type: 'geojson',\r\n              data: data.routes[0].geometry\r\n            });\r\n            map.addLayer({\r\n              id: `route-${index}`,\r\n              type: 'line',\r\n              source: `route-${index}`,\r\n              layout: {\r\n                'line-join': 'round',\r\n                'line-cap': 'round'\r\n              },\r\n              paint: {\r\n                'line-color': destination.color,\r\n                // Use the specified color for each route\r\n                'line-width': 3\r\n              }\r\n            });\r\n          }).catch(error => {\r\n            console.error('There was a problem with the fetch operation:', error);\r\n          });\r\n  \r\n          // Create a marker for the destination and name it marker_destination\r\n          const marker_destination = new mapboxgl.Marker({\r\n            element: createCustomMarkerElementForDestination(index),\r\n            anchor: 'center'\r\n          })\r\n            .setLngLat(destination.coordinates)\r\n            .addTo(map);\r\n\r\n          // Store the destination information as a property of the marker\r\n          marker_destination.properties = {\r\n            name: `Destination ${index + 1}`,\r\n            filepath: destination.filepath,\r\n            location_id:destination.location_id,\r\n            alert_by:destination.alert_by\r\n          };\r\n\r\n          // Create a custom popup\r\n          const destinationCustomPopup = new mapboxgl.Popup({ offset: 10 })\r\n            .setDOMContent(createCustomPopupContentForDestination(index, marker_destination.properties.location_id));\r\n\r\n          // Set the popup for the marker\r\n          marker_destination.setPopup(destinationCustomPopup);\r\n\r\n          // Show the popup on marker hover\r\n          marker_destination.getElement().addEventListener('mouseenter', () => {\r\n            destinationCustomPopup.addTo(map);\r\n          });\r\n\r\n          // Remove the popup on marker mouseleave\r\n          marker_destination.getElement().addEventListener('mouseleave', () => {\r\n            destinationCustomPopup.remove();\r\n          });\r\n\r\n\r\n          // Add data-coreui-toggle and data-coreui-target attributes to the marker element\r\n          marker_destination.getElement().setAttribute('data-coreui-toggle', 'modal');\r\n          marker_destination.getElement().setAttribute('data-coreui-target', '#show_accident_incident_area');\r\n\r\n          // Show the custom popup on marker click\r\n          marker_destination.getElement().addEventListener('click', () => {\r\n          \r\n          const fileUrl = marker_destination.properties.filepath;\r\n          const alertLocation = marker_destination.properties.location_id;\r\n          const alertBy =  marker_destination.properties.alert_by;\r\n          setContent(fileUrl, alertLocation, alertBy, false);\r\n\r\n          });\r\n\r\n        });\r\n      });\r\n    }\r\n  \r\n    // Call the updateMap function with the initial destinations\r\n    updateMap(destinations);\r\n  \r\n    // Get elements by class name\r\n    const headerTogglers = document.getElementsByClassName(\"header-toggler\");\r\n    const sidebarTogglers = document.getElementsByClassName(\"sidebar-toggler\");\r\n  \r\n    // Loop through the elements and add event listener\r\n    for (let i = 0; i < headerTogglers.length; i++) {\r\n      headerTogglers[i].addEventListener(\"click\", function () {\r\n        // Trigger a map resize event when the sidebar state changes\r\n        setTimeout(() => {\r\n          map.resize();\r\n        }, 300);\r\n      });\r\n    }\r\n    for (let i = 0; i < sidebarTogglers.length; i++) {\r\n      sidebarTogglers[i].addEventListener(\"click\", function () {\r\n        // Trigger a map resize event when the sidebar state changes\r\n        setTimeout(() => {\r\n          map.resize();\r\n        }, 300);\r\n      });\r\n    }\r\n  \r\n    // Function to create a custom marker element for destination\r\n    function createCustomMarkerElementForDestination(index) {\r\n      const customMarker = document.createElement('div');\r\n      customMarker.className = 'custom-marker';\r\n      customMarker.style.backgroundImage = `url('../assets/brand/alert.png')`; // Adjust the path accordingly\r\n      customMarker.style.width = '50px'; // Adjust the width and height of your custom marker\r\n      customMarker.style.height = '50px';\r\n      customMarker.style.backgroundSize = 'cover'; // Set the background size to cover\r\n      return customMarker;\r\n    }\r\n    \r\n    // Function to create a custom marker element for the origin\r\n    function createCustomMarkerElementForOrigin() {\r\n      const customMarker = document.createElement('div');\r\n      customMarker.className = 'custom-marker';\r\n      customMarker.style.backgroundImage = 'url(\"../assets/brand/police.png\")'; // Specify the path to your custom origin marker image\r\n      customMarker.style.width = '70px'; // Adjust the width and height as needed\r\n      customMarker.style.height = '70px';\r\n      customMarker.style.backgroundSize = 'cover'; // Maintain the image aspect ratio\r\n  \r\n      return customMarker;\r\n    }\r\n\r\n    // Function to create a custom marker element for the hospital\r\n    function createCustomMarkerElementForHospital(index) {\r\n      const customMarker = document.createElement('div');\r\n      customMarker.className = 'custom-marker-hospital';\r\n      customMarker.style.backgroundImage = `url('../assets/brand/hospital.png')`; // Adjust the path accordingly\r\n      customMarker.style.width = '70px'; // Adjust the width and height of your custom marker\r\n      customMarker.style.height = '70px';\r\n      customMarker.style.backgroundSize = 'cover'; // Set the background size to cover\r\n      return customMarker;\r\n    }\r\n    \r\n    // Function to create a custom popup content \r\n    function createCustomPopupContentForOrigin() {\r\n      // Create a container element for the popup\r\n      const popupContainer = document.createElement('div');\r\n      popupContainer.className = 'custom-popup';\r\n    \r\n      // Add your custom content to the popup\r\n      const popupContent = document.createElement('div');\r\n      popupContent.textContent = profile_name + ' station '+ hq + ' headquarter.' ;\r\n    \r\n      // Append the content to the container\r\n      popupContainer.appendChild(popupContent);\r\n    \r\n      return popupContainer;\r\n    }\r\n\r\n    function createCustomPopupContentForDestination(index, destination) {\r\n      // Create a container element for the popup\r\n      const popupContainer = document.createElement('div');\r\n      popupContainer.className = 'custom-popup';\r\n    \r\n      // Add your custom content to the popup\r\n      const popupContent = document.createElement('div');\r\n      popupContent.textContent = destination;\r\n    \r\n      // Append the content to the container\r\n      popupContainer.appendChild(popupContent);\r\n    \r\n      return popupContainer;\r\n    }\r\n\r\n    function createCustomPopupContentForHospital(hospital_name, hospital_address) {\r\n      // Create a container element for the popup\r\n      const popupContainer = document.createElement('div');\r\n      popupContainer.className = 'custom-popup';\r\n\r\n      // Add your custom content to the popup\r\n      const popupContent = document.createElement('div');\r\n      popupContent.textContent = hospital_name + ', '+ hospital_address + '.' ;\r\n\r\n      // Append the content to the container\r\n      popupContainer.appendChild(popupContent);\r\n\r\n      return popupContainer;\r\n    }\r\n    \r\n    // Function to find the nearest hospital\r\n    function findNearestHospital(destinationCoordinates, hospitals) {\r\n      let nearestHospital = null;\r\n      let minDistance = Infinity;\r\n      let hospital_name = null;\r\n      let hospital_address = null;\r\n\r\n      hospitals.forEach(hospital => {\r\n        const distance = calculateDistance(destinationCoordinates, [hospital.lat, hospital.long]);\r\n        if (distance < minDistance) {\r\n          minDistance = distance;\r\n          nearestHospital = [hospital.lat, hospital.long];\r\n          hospital_name = [hospital.docId];\r\n          hospital_address = [hospital.hospital_address];\r\n        }\r\n      });\r\n\r\n      return {\r\n                nearestHospital:nearestHospital,\r\n                hospital_name:hospital_name,\r\n                hospital_address:hospital_address\r\n             };\r\n    }\r\n\r\n    function calculateDistance(coord1, coord2) {\r\n      const R = 6371; // Radius of the earth in km\r\n      const dLat = deg2rad(coord2[0] - coord1[1]);\r\n      const dLon = deg2rad(coord2[1] - coord1[0]);\r\n     // console.log(\"coord 1: \", coord2[0], \" - \", coord1[1])\r\n      //console.log(\"coord 2: \", coord2[1], \" - \", coord1[0])\r\n      const a =\r\n        Math.sin(dLat / 2) * Math.sin(dLat / 2) +\r\n        Math.cos(deg2rad(coord1[1])) * Math.cos(deg2rad(coord2[0])) *\r\n        Math.sin(dLon / 2) * Math.sin(dLon / 2);\r\n      const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n      const distance = R * c; // Distance in km\r\n      return distance;\r\n    }\r\n    \r\n    function deg2rad(deg) {\r\n      return deg * (Math.PI / 180);\r\n    }\r\n\r\n  }\r\n\r\n  // Function to set the content based on file extension\r\n  export function setContent(fileUrl, alertLocation, alertBy, isResponded) {\r\n    const fileExtension = getFileExtension(fileUrl);\r\n    const videoElement = document.getElementById('videoElement');\r\n    const videoContainer = document.getElementById('videoContainer');\r\n    const imageElement = document.getElementById('imageElement');\r\n    const imageContainer = document.getElementById('imageContainer');\r\n    const incidentLocation = document.getElementById('accident_incident_area_title');\r\n    const personWhoAlerted = document.getElementById('alerterId');\r\n    const respondButton = document.getElementById('respond_btn');\r\n    const markAsDoneButton = document.getElementById('mark_as_done');\r\n\r\n    if(isResponded)\r\n    {\r\n      respondButton.classList.add('d-none');\r\n      markAsDoneButton.classList.remove('d-none');\r\n    }\r\n    else\r\n    {\r\n      markAsDoneButton.classList.add('d-none');\r\n      respondButton.classList.remove('d-none'); \r\n    }\r\n\r\n    incidentLocation.textContent = alertLocation;\r\n    personWhoAlerted.textContent = alertBy;\r\n  \r\n    const videoExtensions = ['mp4', 'webm', 'ogg'];\r\n    const imageExtensions = ['jpg', 'jpeg', 'png', 'gif'];\r\n  \r\n    if (videoExtensions.includes(fileExtension)) {\r\n      // Display the video element\r\n      videoElement.style.display = 'block';\r\n      videoContainer.classList.remove('d-none');\r\n      imageContainer.classList.add('d-none');\r\n      imageElement.style.display = 'none';\r\n      videoElement.src = fileUrl;\r\n      videoElement.load();\r\n     \r\n    } else if (imageExtensions.includes(fileExtension)) {\r\n      // Display the image element\r\n      imageElement.style.display = 'block';\r\n      videoElement.style.display = 'none';\r\n      videoContainer.classList.add('d-none');\r\n      imageContainer.classList.remove('d-none');\r\n      imageElement.src = fileUrl; // Set the source for the image\r\n      const imageLink = document.getElementById('imageLink');\r\n      imageLink.href = fileUrl; // Set the link to the extracted file URL\r\n    }\r\n\r\n  }\r\n\r\n  export function getFileExtension(url) {\r\n    const path = new URL(url).pathname;\r\n    const parts = path.split('.');\r\n    if (parts.length > 1) {\r\n      return parts[parts.length - 1].toLowerCase();\r\n    }\r\n    return null;\r\n  }\r\n"],"mappings":"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"}